<template id="RoleManage">
  <div class="roleData">
    <div class="head box-header ">
      <div class="title">
 	 <h5>角色管理</h5>
      </div>
      <div>
        <el-button type="primary" @click="addRow()">新增</el-button>
       <el-button type="primary" @click="able" :disabled="stateAble">启用</el-button>
        <el-button type="primary"  @click="disable" :disabled="stateDisable">禁用</el-button>
        <el-button type="primary" @click="del" :disabled="stateDel">删除</el-button>
      </div>
    </div>
    <div class="list" :style="{height:boxHeight}">
      <el-table
      	ref="multipleTable"
        :data="tableData"
         :height="maxHeight"
         @row-click="rowClick"
        :row-style="rowClass"
        border
        @selection-change="handleSelectionChange"
        @sort-change="sortChange"
      >
        <el-table-column
          type="index"
          :index="indexMethod"
           label="序号"
          width="50">
        </el-table-column>
        <el-table-column
          type="selection"
          width="50">
        </el-table-column>
        <el-table-column
          prop="JSMC"
          label="角色名称"
          sortable="custom"
        >
          <template slot-scope="scope">
             <span v-show="!scope.row.isShow">{{ scope.row.JSMC }}</span>
          </template>
        </el-table-column>
        <el-table-column
        	prop="LX"
          label="类型"
          sortable="custom"
        >
          <template slot-scope="scope">
            <span v-show="!scope.row.isShow">{{ scope.row.LX }}</span>
          </template>
        </el-table-column>
        <el-table-column
        	prop="MS"
          label="描述"
          sortable="custom"
        >
          <template slot-scope="scope">
            <span v-show="!scope.row.isShow">{{ scope.row.MS }}</span>
          </template>
        </el-table-column>
        <el-table-column
        	prop="ZT"
          label="状态"
          width="80"
          sortable="custom"
        >
          <template slot-scope="scope">
            <span >{{ scope.row.ZT=="1"?"正常":"角色锁定" }}</span>
          </template>
        </el-table-column>
       <el-table-column 
            label="操作"
            >
            <template slot-scope="scope">
              <el-button
              	type="primary"
                size="mini"
                @click.stop="handleEdit(scope.$index, scope.row)">
                编辑
              </el-button>
              <el-button
              	type="primary"
                size="mini"
                @click.stop="jsfp(scope.$index, scope.row)">
                分配角色
              </el-button>
            </template>
          </el-table-column>
      </el-table>
     <el-dialog :title="diatitle" :visible.sync="isDialog" :close-on-click-modal="false" @close="close" v-drag>
          <el-form :model="form" :rules="rules" ref="ruleForm" label-position="left" label-width="auto">
           
            <el-form-item label="角色名称" prop="JSMC">
              <el-input v-model="form.JSMC"></el-input>
            </el-form-item>
            <el-form-item label="类型" prop="LX">
              <el-input v-model="form.LX"></el-input>
            </el-form-item>
            <el-form-item label="描述" prop="MS">
              <el-input v-model="form.MS"></el-input>
            </el-form-item>
           
          </el-form>
          <div slot="footer" class="dialog-footer">
            <el-button type="primary" @click="cancel">取 消</el-button>
            <el-button type="primary" @click="updateData('ruleForm')">确 定</el-button>
          </div>
        </el-dialog>
        
         <el-dialog title="分配角色" :visible.sync="isDialog2" :close-on-click-modal="false" @close="close2" v-drag width="55%">
         	<el-row type="flex" :gutter="10" justify="space-between" style="height:400px;">
         		<el-col :span="7">
         			<div style="height:400px;border:1px solid #e0e0e0;">
         				<el-tree :data="data" :props="defaultProps" @node-click="handleNodeClick" :expand-on-click-node="false" highlight-current></el-tree>
         			</div>
         		</el-col>
         		<el-col :span="17">
         			<div style="text-align: right;margin-bottom:10px;">
         				<el-button type="primary" @click="search">查询</el-button>
         				<!-- <el-button type="primary">保存</el-button> -->
         			</div>
       				<el-form :model="formData" label-width="100px" ref="searchForm">
       					<el-row>
       						<el-col :span="12">
       							<el-form-item label="人员姓名" prop="XM">
				                    <el-input v-model="formData.XM" placeholder=""></el-input>
				                  </el-form-item>
       						</el-col>
         					<el-col :span="12">
         						<el-form-item label="用户姓名" prop="YHM">
				                    <el-input v-model="formData.YHM" placeholder=""></el-input>
				                  </el-form-item>
         					</el-col>
       					</el-row>
       				</el-form>
       				<div style="border: 1px solid #e0e0e0;height:297px;width:100%;position: relative;">
       					<el-table
			                border
			                :data="tableData2"
			                tooltip-effect="dark"
			                height="258"
			                style="width: 100%">
			                <el-table-column
			                  type="index"
			                  width="40">
			                </el-table-column>
			                <el-table-column
			                  prop="XM"
			                  label="人员姓名"
			                  sortable="custom"
			                  >
			                  <!-- <template slot-scope="scope">
			                    <span :title="scope.row.JGMC">{{scope.row.JGMC}}</span>
			                  </template> -->
			                </el-table-column>
			                <el-table-column
			                  prop="YHM"
			                  label="用户名"
			                  sortable="custom"
			                  >
			                  <!-- <template slot-scope="scope">
			                    <span :title="scope.row.JGMC">{{scope.row.JGMC}}</span>
			                  </template> -->
			                </el-table-column>
			                <el-table-column
			                  prop="isfp"
			                  label="是否分配"
			                  sortable="custom"
			                  width="110"
			                  >
			                  <template slot-scope="scope">
			                    <span>{{ scope.row.isfp }}</span>
			                  </template>
			                </el-table-column>
			                <el-table-column
			                  label="操作"
			                  >
			                  <template slot-scope="scope">
			                  	<el-button type="primary" size="mini" @click="deleteRole(scope.row)">删除</el-button>
			                  	<el-button type="primary" size="mini" @click="assignment(scope.row)">分配</el-button>
			                  </template>
			                </el-table-column>
			            </el-table>
			            <div class="pagination">
			            	<el-pagination
				                @size-change="handleSizeChange2"
				                @current-change="handleCurrentChange2"
				                :current-page="currentPage2"
				                :page-sizes="[10,20,30]"
				                :page-size="pageSize2"
				                layout="total, sizes, prev, pager, next, jumper"
				                :total=total2>
				            </el-pagination>
			            </div>
       				</div>
         		</el-col>
         	</el-row>
        </el-dialog>
      <div class="pagination">
        <el-pagination
          @size-change="handleSizeChange"
          @current-change="handleCurrentChange"
          :current-page="currentPage"
          :page-sizes="[10,20,30]"
          :page-size="pageSize"
          layout="total, sizes, prev, pager, next, jumper"
          :total=total>
        </el-pagination>
      </div>
    </div>
  </div>
</template>
